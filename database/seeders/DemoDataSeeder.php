<?php

namespace Database\Seeders;

use App\Models\Document;
use App\Models\DocumentType;
use App\Models\User;
use App\Models\Department;
use Illuminate\Database\Seeder;
use Illuminate\Support\Str;

class DemoDataSeeder extends Seeder
{
    /**
     * Seed р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕Зр╣Ар╕нр╕Бр╕кр╕▓р╕гр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Бр╕▓р╕г demo
     */
    public function run(): void
    {
        // р╕Фр╕╢р╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣Ир╕Ир╕│р╣Ар╕Ыр╣Зр╕Щ
        $users = User::all();
        $documentTypes = DocumentType::all();
        $departments = Department::all();

        if ($users->isEmpty() || $documentTypes->isEmpty()) {
            $this->command->warn('тЪая╕П р╣Др╕бр╣Ир╕Юр╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╕лр╕гр╕╖р╕нр╕Ыр╕гр╕░р╣Ар╕ар╕Чр╣Ар╕нр╕Бр╕кр╕▓р╕г р╕Бр╕гр╕╕р╕Ур╕▓ seed р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Юр╕╖р╣Йр╕Щр╕Рр╕▓р╕Щр╕Бр╣Ир╕нр╕Щ');
            return;
        }

        // р╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕нр╕Бр╕кр╕▓р╕гр╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕З
        $sampleDocuments = [
            [
                'title' => 'р╕Др╕│р╕кр╕▒р╣Ир╕Зр╣Бр╕Хр╣Ир╕Зр╕Хр╕▒р╣Йр╕Зр╕Др╕Ур╕░р╕Бр╕гр╕гр╕бр╕Бр╕▓р╕гр╕Фр╕│р╣Ар╕Щр╕┤р╕Щр╕Зр╕▓р╕Щр╕Ыр╕╡р╕Бр╕▓р╕гр╕ир╕╢р╕Бр╕йр╕▓ 2567',
                'description' => 'р╣Ар╕Юр╕╖р╣Ир╕нр╣Гр╕лр╣Йр╕Бр╕▓р╕гр╕Фр╕│р╣Ар╕Щр╕┤р╕Щр╕Зр╕▓р╕Щр╕Вр╕нр╕Зр╣Вр╕гр╕Зр╣Ар╕гр╕╡р╕вр╕Щр╣Ар╕Ыр╣Зр╕Щр╣Др╕Ыр╕Фр╣Йр╕зр╕вр╕Др╕зр╕▓р╕бр╣Ар╕гр╕╡р╕вр╕Ър╕гр╣Йр╕нр╕в р╕Ир╕╢р╕Зр╣Бр╕Хр╣Ир╕Зр╕Хр╕▒р╣Йр╕Зр╕Др╕Ур╕░р╕Бр╕гр╕гр╕бр╕Бр╕▓р╕гр╕Фр╕│р╣Ар╕Щр╕┤р╕Щр╕Зр╕▓р╕Щр╕Ыр╕гр╕░р╕Ир╕│р╕Ыр╕╡р╕Бр╕▓р╕гр╕ир╕╢р╕Бр╕йр╕▓ 2567',
                'document_type' => 'р╕Др╕│р╕кр╕▒р╣Ир╕З',
                'status' => 'pending_director',
            ],
            [
                'title' => 'р╕Ыр╕гр╕░р╕Бр╕▓р╕ир╕гр╕▒р╕Ър╕кр╕бр╕▒р╕Др╕гр╕Щр╕▒р╕Бр╣Ар╕гр╕╡р╕вр╕Щр╣Гр╕лр╕бр╣И р╕Ыр╕╡р╕Бр╕▓р╕гр╕ир╕╢р╕Бр╕йр╕▓ 2568',
                'description' => 'р╣Вр╕гр╕Зр╣Ар╕гр╕╡р╕вр╕Щр╕Ир╕░р╣Ар╕Ыр╕┤р╕Фр╕гр╕▒р╕Ър╕кр╕бр╕▒р╕Др╕гр╕Щр╕▒р╕Бр╣Ар╕гр╕╡р╕вр╕Щр╣Гр╕лр╕бр╣И р╕гр╕░р╕Фр╕▒р╕Ър╕Кр╕▒р╣Йр╕Щр╕бр╕▒р╕Шр╕вр╕бр╕ир╕╢р╕Бр╕йр╕▓р╕Ыр╕╡р╕Чр╕╡р╣И 1 р╣Бр╕ер╕░ 4 р╕Ыр╕гр╕░р╕Ир╕│р╕Ыр╕╡р╕Бр╕▓р╕гр╕ир╕╢р╕Бр╕йр╕▓ 2568',
                'document_type' => 'р╕Ыр╕гр╕░р╕Бр╕▓р╕и',
                'status' => 'completed',
            ],
            [
                'title' => 'р╕лр╕Щр╕▒р╕Зр╕кр╕╖р╕нр╕Вр╕нр╕Др╕зр╕▓р╕бр╕нр╕Щр╕╕р╣Ар╕Др╕гр╕▓р╕░р╕лр╣Мр╕кр╕Цр╕▓р╕Щр╕Чр╕╡р╣Ир╕Ир╕▒р╕Фр╕Бр╕┤р╕Ир╕Бр╕гр╕гр╕бр╕зр╕▒р╕Щр╕Бр╕╡р╕мр╕▓р╕кр╕╡',
                'description' => 'р╕Вр╕нр╕Др╕зр╕▓р╕бр╕нр╕Щр╕╕р╣Ар╕Др╕гр╕▓р╕░р╕лр╣Мр╕кр╕Цр╕▓р╕Щр╕Чр╕╡р╣Ир╕кр╕│р╕лр╕гр╕▒р╕Ър╕Ир╕▒р╕Фр╕Бр╕┤р╕Ир╕Бр╕гр╕гр╕бр╕зр╕▒р╕Щр╕Бр╕╡р╕мр╕▓р╕кр╕╡р╕Ыр╕гр╕░р╕Ир╕│р╕Ыр╕╡ р╣Ар╕Юр╕╖р╣Ир╕нр╕кр╣Ир╕Зр╣Ар╕кр╕гр╕┤р╕бр╕Др╕зр╕▓р╕бр╕кр╕▓р╕бр╕▒р╕Др╕Др╕╡р╕Вр╕нр╕Зр╕Щр╕▒р╕Бр╣Ар╕гр╕╡р╕вр╕Щ',
                'document_type' => 'р╕лр╕Щр╕▒р╕Зр╕кр╕╖р╕нр╕ар╕▓р╕вр╕Щр╕нр╕Б',
                'status' => 'pending_deputy_director_1',
            ],
            [
                'title' => 'р╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕б р╣Ар╕гр╕╖р╣Ир╕нр╕З р╕Бр╕▓р╕гр╕Ыр╕гр╕░р╕Кр╕╕р╕бр╕Др╕гр╕╣р╕Ыр╕гр╕░р╕Ир╕│р╣Ар╕Фр╕╖р╕нр╕Щ',
                'description' => 'р╣Бр╕Ир╣Йр╕Зр╣Гр╕лр╣Йр╕Др╕гр╕╣р╕Чр╕╕р╕Бр╕Чр╣Ир╕▓р╕Щр╣Ар╕Вр╣Йр╕▓р╕гр╣Ир╕зр╕бр╕Ыр╕гр╕░р╕Кр╕╕р╕бр╕Ыр╕гр╕░р╕Ир╕│р╣Ар╕Фр╕╖р╕нр╕Щ р╣Ар╕Юр╕╖р╣Ир╕нр╕лр╕▓р╕гр╕╖р╕нр╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Бр╕▒р╕Ър╣Бр╕Ьр╕Щр╕Бр╕▓р╕гр╣Ар╕гр╕╡р╕вр╕Щр╕Бр╕▓р╕гр╕кр╕нр╕Щ',
                'document_type' => 'р╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕б',
                'status' => 'pending_stamp',
            ],
            [
                'title' => 'р╕гр╕▓р╕вр╕Зр╕▓р╕Щр╕Ьр╕ер╕Бр╕▓р╕гр╕Фр╕│р╣Ар╕Щр╕┤р╕Щр╕Зр╕▓р╕Щр╣Вр╕Др╕гр╕Зр╕Бр╕▓р╕гр╕Юр╕▒р╕Тр╕Щр╕▓р╕Др╕╕р╕Ур╕ар╕▓р╕Юр╕Бр╕▓р╕гр╕ир╕╢р╕Бр╕йр╕▓',
                'description' => 'р╕гр╕▓р╕вр╕Зр╕▓р╕Щр╕кр╕гр╕╕р╕Ыр╕Ьр╕ер╕Бр╕▓р╕гр╕Фр╕│р╣Ар╕Щр╕┤р╕Щр╕Зр╕▓р╕Щр╣Вр╕Др╕гр╕Зр╕Бр╕▓р╕гр╕Юр╕▒р╕Тр╕Щр╕▓р╕Др╕╕р╕Ур╕ар╕▓р╕Юр╕Бр╕▓р╕гр╕ир╕╢р╕Бр╕йр╕▓ р╕Ыр╕гр╕░р╕Ир╕│р╕ар╕▓р╕Др╣Ар╕гр╕╡р╕вр╕Щр╕Чр╕╡р╣И 1',
                'document_type' => 'р╕гр╕▓р╕вр╕Зр╕▓р╕Щр╕Бр╕▓р╕гр╕Ыр╕Пр╕┤р╕Ър╕▒р╕Хр╕┤р╕Зр╕▓р╕Щ',
                'status' => 'completed',
            ],
            [
                'title' => 'р╕лр╕Щр╕▒р╕Зр╕кр╕╖р╕нр╣Ар╕зр╕╡р╕вр╕Щ р╣Ар╕гр╕╖р╣Ир╕нр╕З р╕бр╕▓р╕Хр╕гр╕Бр╕▓р╕гр╕Ыр╣Йр╕нр╕Зр╕Бр╕▒р╕Щр╣Вр╕гр╕Др╕Хр╕┤р╕Фр╕Хр╣Ир╕нр╣Гр╕Щр╣Вр╕гр╕Зр╣Ар╕гр╕╡р╕вр╕Щ',
                'description' => 'р╣Бр╕Ир╣Йр╕Зр╕бр╕▓р╕Хр╕гр╕Бр╕▓р╕гр╕Ыр╣Йр╕нр╕Зр╕Бр╕▒р╕Щр╣Вр╕гр╕Др╕Хр╕┤р╕Фр╕Хр╣Ир╕нр╣Гр╕Щр╣Вр╕гр╕Зр╣Ар╕гр╕╡р╕вр╕Щ р╣Ар╕Юр╕╖р╣Ир╕нр╕Др╕зр╕▓р╕бр╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕вр╕Вр╕нр╕Зр╕Щр╕▒р╕Бр╣Ар╕гр╕╡р╕вр╕Щр╣Бр╕ер╕░р╕Ър╕╕р╕Др╕ер╕▓р╕Бр╕г',
                'document_type' => 'р╕лр╕Щр╕▒р╕Зр╕кр╕╖р╕нр╣Ар╕зр╕╡р╕вр╕Щ',
                'status' => 'completed',
            ],
            [
                'title' => 'р╣Гр╕Ър╕ер╕▓р╕Ыр╣Ир╕зр╕вр╕Вр╕нр╕Зр╕Др╕гр╕╣р╕кр╕╕р╕Фр╕▓ р╕ар╕▓р╕йр╕▓р╣Др╕Чр╕в',
                'description' => 'р╕Вр╕нр╕ер╕▓р╕Ыр╣Ир╕зр╕вр╣Ар╕Щр╕╖р╣Ир╕нр╕Зр╕Ир╕▓р╕Бр╕бр╕╡р╕нр╕▓р╕Бр╕▓р╕гр╣Др╕Вр╣Йр╕лр╕зр╕▒р╕Фр╣Гр╕лр╕Нр╣И р╕гр╕░р╕вр╕░р╣Ар╕зр╕ер╕▓ 3 р╕зр╕▒р╕Щ',
                'document_type' => 'р╣Гр╕Ър╕ер╕▓',
                'status' => 'pending_deputy_director_2',
            ],
            [
                'title' => 'р╣Бр╕Ьр╕Щр╕Бр╕▓р╕гр╣Ар╕гр╕╡р╕вр╕Щр╕гр╕╣р╣Йр╕зр╕┤р╕Кр╕▓р╕Др╕Ур╕┤р╕Хр╕ир╕▓р╕кр╕Хр╕гр╣М р╕б.1',
                'description' => 'р╣Бр╕Ьр╕Щр╕Бр╕▓р╕гр╣Ар╕гр╕╡р╕вр╕Щр╕гр╕╣р╣Йр╕зр╕┤р╕Кр╕▓р╕Др╕Ур╕┤р╕Хр╕ир╕▓р╕кр╕Хр╕гр╣М р╕гр╕░р╕Фр╕▒р╕Ър╕Кр╕▒р╣Йр╕Щр╕бр╕▒р╕Шр╕вр╕бр╕ир╕╢р╕Бр╕йр╕▓р╕Ыр╕╡р╕Чр╕╡р╣И 1 р╕ар╕▓р╕Др╣Ар╕гр╕╡р╕вр╕Щр╕Чр╕╡р╣И 2',
                'document_type' => 'р╣Бр╕Ьр╕Щр╕Бр╕▓р╕гр╣Ар╕гр╕╡р╕вр╕Щр╕гр╕╣р╣Й',
                'status' => 'pending_deputy_director_1',
            ],
            [
                'title' => 'р╕Зр╕Ър╕Ыр╕гр╕░р╕бр╕▓р╕Ур╕Ир╕▒р╕Фр╕Лр╕╖р╣Йр╕нр╕нр╕╕р╕Ыр╕Бр╕гр╕Ур╣Мр╕Бр╕▓р╕гр╣Ар╕гр╕╡р╕вр╕Щр╕Бр╕▓р╕гр╕кр╕нр╕Щ',
                'description' => 'р╕Вр╕нр╕нр╕Щр╕╕р╕бр╕▒р╕Хр╕┤р╕Зр╕Ър╕Ыр╕гр╕░р╕бр╕▓р╕Ур╕кр╕│р╕лр╕гр╕▒р╕Ър╕Ир╕▒р╕Фр╕Лр╕╖р╣Йр╕нр╕нр╕╕р╕Ыр╕Бр╕гр╕Ур╣Мр╕Бр╕▓р╕гр╣Ар╕гр╕╡р╕вр╕Щр╕Бр╕▓р╕гр╕кр╕нр╕Щр╕Ыр╕гр╕░р╕Ир╕│р╕Ыр╕╡р╕Бр╕▓р╕гр╕ир╕╢р╕Бр╕йр╕▓ 2567',
                'document_type' => 'р╕Зр╕Ър╕Ыр╕гр╕░р╕бр╕▓р╕У',
                'status' => 'pending_distribution',
            ],
            [
                'title' => 'р╣Гр╕Ър╕нр╕Щр╕╕р╕Нр╕▓р╕Хр╕Ир╕▒р╕Фр╕Бр╕┤р╕Ир╕Бр╕гр╕гр╕бр╕Др╣Ир╕▓р╕вр╕зр╕┤р╕Чр╕вр╕▓р╕ир╕▓р╕кр╕Хр╕гр╣М',
                'description' => 'р╕Вр╕нр╕нр╕Щр╕╕р╕Нр╕▓р╕Хр╕Ир╕▒р╕Фр╕Бр╕┤р╕Ир╕Бр╕гр╕гр╕бр╕Др╣Ир╕▓р╕вр╕зр╕┤р╕Чр╕вр╕▓р╕ир╕▓р╕кр╕Хр╕гр╣Мр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Щр╕▒р╕Бр╣Ар╕гр╕╡р╕вр╕Щр╕Кр╕▒р╣Йр╕Щр╕бр╕▒р╕Шр╕вр╕бр╕ир╕╢р╕Бр╕йр╕▓р╕Ыр╕╡р╕Чр╕╡р╣И 2',
                'document_type' => 'р╣Гр╕Ър╕нр╕Щр╕╕р╕Нр╕▓р╕Хр╕Бр╕┤р╕Ир╕Бр╕гр╕гр╕б',
                'status' => 'completed',
            ],
        ];

        $createdCount = 0;

        foreach ($sampleDocuments as $docData) {
            // р╕лр╕▓р╕Ыр╕гр╕░р╣Ар╕ар╕Чр╣Ар╕нр╕Бр╕кр╕▓р╕г
            $documentType = $documentTypes->where('name', $docData['document_type'])->first();
            if (!$documentType) {
                continue;
            }

            // р╕кр╕╕р╣Ир╕бр╕Ьр╕╣р╣Йр╕кр╕гр╣Йр╕▓р╕Зр╣Ар╕нр╕Бр╕кр╕▓р╕г
            $creator = $users->random();

            // р╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣М path р╕Ир╕│р╕ер╕нр╕З
            $fileName = Str::slug($docData['title']) . '.pdf';
            $filePath = 'documents/' . $fileName;

            try {
                Document::create([
                    'title' => $docData['title'],
                    'description' => $docData['description'],
                    'file_path' => $filePath,
                    'current_file_path' => $filePath,
                    'document_type_id' => $documentType->id,
                    'user_id' => $creator->id,
                    'is_public' => rand(0, 1) == 1,
                    'status' => $docData['status'],
                    'current_step' => $docData['status'] === 'draft' ? 1 : rand(1, 3),
                    'created_at' => now()->subDays(rand(1, 30)),
                    'updated_at' => now()->subDays(rand(0, 5)),
                ]);
                
                $createdCount++;
            } catch (\Exception $e) {
                $this->command->warn("тЪая╕П р╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╕кр╕гр╣Йр╕▓р╕Зр╣Ар╕нр╕Бр╕кр╕▓р╕г '{$docData['title']}' р╣Др╕Фр╣Й: " . $e->getMessage());
            }
        }

        $this->command->info("тЬЕ р╕кр╕гр╣Йр╕▓р╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕нр╕Бр╕кр╕▓р╕гр╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕З {$createdCount} р╕Йр╕Ър╕▒р╕Ъ р╣Ар╕гр╕╡р╕вр╕Ър╕гр╣Йр╕нр╕в");
        $this->command->info("ЁЯУД р╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕нр╕Бр╕кр╕▓р╕гр╕Юр╕гр╣Йр╕нр╕бр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Бр╕▓р╕г demo р╣Бр╕ер╣Йр╕з");
    }
} 